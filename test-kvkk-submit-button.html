<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test: KVKK Submit Button Integration</title>
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <style>
        body {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-info {
            background: #f0fdfa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #0891b2;
        }
        .test-info h1 {
            margin: 0 0 10px 0;
            color: #0891b2;
        }
        .test-instructions {
            background: #fff7ed;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #f97316;
        }
        .test-instructions h2 {
            margin: 0 0 10px 0;
            color: #f97316;
            font-size: 18px;
        }
        .test-instructions ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        .test-instructions li {
            margin: 5px 0;
        }
        #test-container {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="test-info">
        <h1>Task 13: KVKK Consent Submit Button Integration</h1>
        <p><strong>Requirement 6.5:</strong> WHEN a User checks the Aydƒ±nlatma Metni checkbox THEN the System SHALL enable the form submit button</p>
    </div>

    <div class="test-instructions">
        <h2>Manual Test Instructions</h2>
        <ol>
            <li>Observe that the submit button below is initially <strong>disabled</strong> (grayed out)</li>
            <li>Check the KVKK consent checkbox</li>
            <li>Verify that the submit button becomes <strong>enabled</strong> (clickable)</li>
            <li>Uncheck the KVKK consent checkbox</li>
            <li>Verify that the submit button becomes <strong>disabled</strong> again</li>
        </ol>
        <p><strong>Expected Result:</strong> Submit button should be disabled when checkbox is unchecked, and enabled when checkbox is checked.</p>
    </div>

    <div id="test-container"></div>

    <script type="module">
        import { SurveyForm } from './js/forms.js';

        // Load a sample survey
        async function loadAndRenderSurvey() {
            try {
                const response = await fetch('data/surveys.json');
                const data = await response.json();
                
                if (data.surveys && data.surveys.length > 0) {
                    const survey = data.surveys[0]; // Use first survey
                    const surveyForm = new SurveyForm(survey);
                    surveyForm.render('test-container');
                    
                    console.log('‚úÖ Survey form rendered successfully');
                    console.log('üìã Survey:', survey.title);
                    
                    // Add visual feedback
                    const submitButton = document.querySelector('button[type="submit"]');
                    const kvkkCheckbox = document.querySelector('#kvkkConsent');
                    
                    if (submitButton && kvkkCheckbox) {
                        console.log('‚úÖ Submit button initial state:', submitButton.disabled ? 'DISABLED' : 'ENABLED');
                        
                        // Add visual indicator
                        const indicator = document.createElement('div');
                        indicator.style.cssText = 'margin-top: 20px; padding: 15px; border-radius: 8px; font-weight: bold;';
                        indicator.id = 'status-indicator';
                        updateIndicator(indicator, submitButton.disabled);
                        document.getElementById('test-container').appendChild(indicator);
                        
                        // Monitor changes
                        kvkkCheckbox.addEventListener('change', () => {
                            setTimeout(() => {
                                console.log('üîÑ Checkbox changed. Submit button state:', submitButton.disabled ? 'DISABLED' : 'ENABLED');
                                updateIndicator(indicator, submitButton.disabled);
                            }, 10);
                        });
                    }
                } else {
                    console.error('‚ùå No surveys found in data');
                }
            } catch (error) {
                console.error('‚ùå Error loading survey:', error);
            }
        }
        
        function updateIndicator(indicator, isDisabled) {
            if (isDisabled) {
                indicator.style.background = '#fef2f2';
                indicator.style.color = '#ef4444';
                indicator.style.borderLeft = '4px solid #ef4444';
                indicator.textContent = 'üîí Submit Button: DISABLED';
            } else {
                indicator.style.background = '#f0fdf4';
                indicator.style.color = '#10b981';
                indicator.style.borderLeft = '4px solid #10b981';
                indicator.textContent = '‚úÖ Submit Button: ENABLED';
            }
        }

        // Load survey on page load
        loadAndRenderSurvey();
    </script>
</body>
</html>
