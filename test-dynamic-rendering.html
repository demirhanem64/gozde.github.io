<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Dynamic Announcement Rendering</title>
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <style>
        body {
            padding: 2rem;
            background-color: var(--color-background);
        }
        .test-section {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .test-result {
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 0.5rem;
            font-weight: 600;
        }
        .test-pass {
            background-color: #d1fae5;
            color: #065f46;
        }
        .test-fail {
            background-color: #fee2e2;
            color: #991b1b;
        }
    </style>
</head>
<body>
    <h1>Test: Dynamic Announcement Rendering (Task 4.3)</h1>
    
    <div class="test-section">
        <h2>Test 1: Announcements Container Exists</h2>
        <div id="test1-result"></div>
    </div>
    
    <div class="test-section">
        <h2>Test 2: Seed Data Loaded</h2>
        <div id="test2-result"></div>
    </div>
    
    <div class="test-section">
        <h2>Test 3: Cards Rendered</h2>
        <div id="test3-result"></div>
    </div>
    
    <div class="test-section">
        <h2>Test 4: Cards Sorted by Date (Newest First)</h2>
        <div id="test4-result"></div>
    </div>
    
    <div class="test-section">
        <h2>Test 5: Empty State Handling</h2>
        <div id="test5-result"></div>
    </div>
    
    <div class="test-section">
        <h2>Visual Preview</h2>
        <div id="announcements-container" class="announcements-container"></div>
    </div>
    
    <script src="js/announcements.js"></script>
    <script>
        function showResult(testId, passed, message) {
            const resultDiv = document.getElementById(testId);
            resultDiv.className = `test-result ${passed ? 'test-pass' : 'test-fail'}`;
            resultDiv.textContent = `${passed ? '‚úì PASS' : '‚úó FAIL'}: ${message}`;
        }
        
        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', function() {
            // Test 1: Container exists
            const container = document.getElementById('announcements-container');
            showResult('test1-result', container !== null, 
                container ? 'Announcements container found' : 'Container not found');
            
            // Test 2: Seed data loaded
            const manager = new AnnouncementManager();
            const announcements = manager.getAll();
            showResult('test2-result', announcements.length > 0, 
                `${announcements.length} announcements loaded from seed data`);
            
            // Test 3: Cards rendered
            setTimeout(() => {
                const cards = container.querySelectorAll('.announcement-card');
                showResult('test3-result', cards.length > 0, 
                    `${cards.length} announcement cards rendered`);
                
                // Test 4: Sorted by date
                const sortedAnnouncements = manager.getSortedByDate();
                let isSorted = true;
                for (let i = 0; i < sortedAnnouncements.length - 1; i++) {
                    const current = sortedAnnouncements[i];
                    const next = sortedAnnouncements[i + 1];
                    const currentDateTime = `${current.date} ${current.time}`;
                    const nextDateTime = `${next.date} ${next.time}`;
                    if (currentDateTime < nextDateTime) {
                        isSorted = false;
                        break;
                    }
                }
                showResult('test4-result', isSorted, 
                    isSorted ? 'Announcements are sorted newest first' : 'Sorting is incorrect');
            }, 100);
            
            // Test 5: Empty state
            localStorage.removeItem('portfolio_announcements');
            const emptyManager = new AnnouncementManager();
            const tempContainer = document.createElement('div');
            tempContainer.id = 'temp-container';
            document.body.appendChild(tempContainer);
            
            // Manually test empty state rendering
            if (emptyManager.getAll().length === 0) {
                tempContainer.innerHTML = `
                    <div class="announcements-empty" style="grid-column: 1 / -1;">
                        <div class="announcements-empty-icon">üì¢</div>
                        <h3 class="announcements-empty-title">Hen√ºz Duyuru Yok</h3>
                        <p class="announcements-empty-message">≈ûu anda g√∂r√ºnt√ºlenecek duyuru bulunmamaktadƒ±r.</p>
                    </div>
                `;
                const emptyState = tempContainer.querySelector('.announcements-empty');
                showResult('test5-result', emptyState !== null, 
                    'Empty state renders correctly when no announcements exist');
                tempContainer.remove();
            }
            
            // Restore seed data
            initializeSeedData();
        });
    </script>
</body>
</html>
