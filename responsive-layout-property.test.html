<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Test: Responsive Layout Adaptation</title>
    
    <!-- Load CSS files -->
    <link rel="stylesheet" href="../css/variables.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/responsive.css">
    
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-results {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-pass {
            color: #10b981;
            font-weight: bold;
        }
        .test-fail {
            color: #ef4444;
            font-weight: bold;
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            border-left: 3px solid #ccc;
        }
        .test-item.pass {
            border-left-color: #10b981;
            background: #f0fdf4;
        }
        .test-item.fail {
            border-left-color: #ef4444;
            background: #fef2f2;
        }
        h1 {
            color: #0f172a;
        }
        .summary {
            margin-top: 20px;
            padding: 15px;
            background: #f0fdfa;
            border-radius: 4px;
        }
        .viewport-simulator {
            border: 2px solid #ccc;
            margin: 10px 0;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <div class="test-results">
        <h1>ðŸ§ª Property-Based Test: Responsive Layout Adaptation</h1>
        <p><strong>Feature:</strong> gozde-eksi-portfolio-website, Property 2: Responsive Layout Adaptation</p>
        <p><strong>Validates:</strong> Requirements 1.4</p>
        <p><strong>Property:</strong> For any viewport width (mobile: &lt;768px, tablet: 768-1024px, desktop: &gt;1024px), 
           the layout should adapt by applying the corresponding media query styles and changing grid/flexbox configurations.</p>
        <hr>
        <div id="test-output"></div>
        <div id="summary" class="summary"></div>
    </div>

    <!-- Test elements -->
    <div style="display: none;">
        <nav class="navigation">
            <div class="nav-container">
                <button class="mobile-menu-toggle"></button>
                <ul class="nav-menu">
                    <li><a href="#" class="nav-link">Test</a></li>
                </ul>
            </div>
        </nav>
        <div class="container"></div>
        <section class="page-section"></section>
        <div class="survey-list"></div>
        <div class="grid-cols-2"></div>
        <div class="grid-cols-3"></div>
        <button class="btn">Test Button</button>
        <input class="form-input" type="text">
    </div>

    <script type="module">
        /**
         * Property-Based Test: Responsive Layout Adaptation
         * 
         * Tests that the layout adapts correctly for different viewport widths
         * by verifying media query application and grid/flexbox changes.
         */

        // Define viewport breakpoints
        const BREAKPOINTS = {
            mobile: { min: 320, max: 767 },
            tablet: { min: 768, max: 1023 },
            desktop: { min: 1024, max: 1920 }
        };

        // Test runner
        const testResults = [];
        let passCount = 0;
        let failCount = 0;

        function logTest(name, passed, details = '') {
            testResults.push({ name, passed, details });
            if (passed) {
                passCount++;
            } else {
                failCount++;
            }
        }

        function getDeviceType(width) {
            if (width < BREAKPOINTS.tablet.min) return 'mobile';
            if (width < BREAKPOINTS.desktop.min) return 'tablet';
            return 'desktop';
        }

        // Create iframe to simulate different viewport widths
        function createViewportSimulator(width) {
            const iframe = document.createElement('iframe');
            iframe.style.width = width + 'px';
            iframe.style.height = '600px';
            iframe.style.border = 'none';
            
            // Copy current page HTML into iframe
            const html = `
                <!DOCTYPE html>
                <html lang="tr">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <link rel="stylesheet" href="../css/variables.css">
                    <link rel="stylesheet" href="../css/base.css">
                    <link rel="stylesheet" href="../css/components.css">
                    <link rel="stylesheet" href="../css/layout.css">
                    <link rel="stylesheet" href="../css/responsive.css">
                </head>
                <body>
                    <nav class="navigation">
                        <div class="nav-container">
                            <button class="mobile-menu-toggle">
                                <span class="hamburger-icon"></span>
                            </button>
                            <ul class="nav-menu">
                                <li><a href="#" class="nav-link">Test</a></li>
                            </ul>
                        </div>
                    </nav>
                    <div class="container">
                        <h1>Test Heading</h1>
                        <h2>Test Subheading</h2>
                    </div>
                    <section class="page-section"></section>
                    <div class="survey-list"></div>
                    <div class="grid-cols-2"></div>
                    <div class="grid-cols-3"></div>
                    <button class="btn">Test Button</button>
                    <input class="form-input" type="text">
                </body>
                </html>
            `;
            
            document.body.appendChild(iframe);
            iframe.contentDocument.open();
            iframe.contentDocument.write(html);
            iframe.contentDocument.close();
            
            return iframe;
        }

        // Test 1: Mobile menu toggle visibility
        function testMobileMenuToggle() {
            const testWidths = [375, 768, 1024, 1440]; // mobile, tablet boundary, desktop, large desktop
            let allPass = true;
            let details = '';
            
            for (const width of testWidths) {
                const iframe = createViewportSimulator(width);
                
                // Wait for iframe to load
                setTimeout(() => {
                    const doc = iframe.contentDocument;
                    const toggle = doc.querySelector('.mobile-menu-toggle');
                    
                    if (toggle) {
                        const styles = iframe.contentWindow.getComputedStyle(toggle);
                        const display = styles.display;
                        const deviceType = getDeviceType(width);
                        
                        if (deviceType === 'mobile') {
                            if (display === 'none') {
                                allPass = false;
                                details += `${width}px (mobile): toggle hidden; `;
                            }
                        } else {
                            if (display !== 'none') {
                                allPass = false;
                                details += `${width}px (${deviceType}): toggle visible; `;
                            }
                        }
                    }
                    
                    document.body.removeChild(iframe);
                }, 100);
            }
            
            setTimeout(() => {
                logTest('Mobile menu toggle visibility adapts to viewport', allPass, details);
                continueTests();
            }, 500);
        }

        // Test 2: Navigation menu layout
        function testNavigationLayout() {
            const testWidths = [375, 768, 1024];
            let allPass = true;
            let details = '';
            
            for (const width of testWidths) {
                const iframe = createViewportSimulator(width);
                
                setTimeout(() => {
                    const doc = iframe.contentDocument;
                    const navMenu = doc.querySelector('.nav-menu');
                    
                    if (navMenu) {
                        const styles = iframe.contentWindow.getComputedStyle(navMenu);
                        const flexDirection = styles.flexDirection;
                        const deviceType = getDeviceType(width);
                        
                        if (deviceType === 'mobile') {
                            if (flexDirection !== 'column') {
                                allPass = false;
                                details += `${width}px: expected column, got ${flexDirection}; `;
                            }
                        } else {
                            if (flexDirection !== 'row') {
                                allPass = false;
                                details += `${width}px: expected row, got ${flexDirection}; `;
                            }
                        }
                    }
                    
                    document.body.removeChild(iframe);
                }, 100);
            }
            
            setTimeout(() => {
                logTest('Navigation menu layout changes with viewport', allPass, details);
                continueTests();
            }, 600);
        }

        // Test 3: Container padding
        function testContainerPadding() {
            const testWidths = [375, 768, 1024, 1440];
            let allPass = true;
            let details = '';
            
            for (const width of testWidths) {
                const iframe = createViewportSimulator(width);
                
                setTimeout(() => {
                    const doc = iframe.contentDocument;
                    const container = doc.querySelector('.container');
                    
                    if (container) {
                        const styles = iframe.contentWindow.getComputedStyle(container);
                        const paddingLeft = parseFloat(styles.paddingLeft);
                        const paddingRight = parseFloat(styles.paddingRight);
                        
                        // Verify padding is symmetric
                        if (paddingLeft !== paddingRight) {
                            allPass = false;
                            details += `${width}px: asymmetric padding (${paddingLeft}px vs ${paddingRight}px); `;
                        }
                        
                        // Verify padding exists
                        if (paddingLeft <= 0) {
                            allPass = false;
                            details += `${width}px: no padding; `;
                        }
                        
                        const deviceType = getDeviceType(width);
                        if (deviceType === 'mobile' && paddingLeft > 24) {
                            allPass = false;
                            details += `${width}px (mobile): padding too large (${paddingLeft}px); `;
                        }
                    }
                    
                    document.body.removeChild(iframe);
                }, 100);
            }
            
            setTimeout(() => {
                logTest('Container padding adapts to viewport', allPass, details);
                continueTests();
            }, 700);
        }

        // Test 4: Typography scaling
        function testTypographyScaling() {
            const testWidths = [375, 768, 1024];
            let allPass = true;
            let details = '';
            
            for (const width of testWidths) {
                const iframe = createViewportSimulator(width);
                
                setTimeout(() => {
                    const doc = iframe.contentDocument;
                    const h1 = doc.querySelector('h1');
                    const h2 = doc.querySelector('h2');
                    
                    if (h1) {
                        const styles = iframe.contentWindow.getComputedStyle(h1);
                        const fontSize = parseFloat(styles.fontSize);
                        
                        if (fontSize <= 0) {
                            allPass = false;
                            details += `${width}px: h1 has no font size; `;
                        }
                        
                        const deviceType = getDeviceType(width);
                        if (deviceType === 'mobile' && fontSize > 36) {
                            allPass = false;
                            details += `${width}px (mobile): h1 too large (${fontSize}px); `;
                        }
                    }
                    
                    if (h2) {
                        const styles = iframe.contentWindow.getComputedStyle(h2);
                        const fontSize = parseFloat(styles.fontSize);
                        
                        if (fontSize <= 0) {
                            allPass = false;
                            details += `${width}px: h2 has no font size; `;
                        }
                    }
                    
                    document.body.removeChild(iframe);
                }, 100);
            }
            
            setTimeout(() => {
                logTest('Typography scales appropriately for viewport', allPass, details);
                continueTests();
            }, 800);
        }

        // Test 5: Touch-friendly button sizes on mobile
        function testTouchFriendlyButtons() {
            const mobileWidths = [375, 414, 600];
            let allPass = true;
            let details = '';
            
            for (const width of mobileWidths) {
                const iframe = createViewportSimulator(width);
                
                setTimeout(() => {
                    const doc = iframe.contentDocument;
                    const button = doc.querySelector('.btn');
                    
                    if (button) {
                        const styles = iframe.contentWindow.getComputedStyle(button);
                        const minHeight = parseFloat(styles.minHeight);
                        
                        // iOS touch target minimum is 44px
                        if (minHeight > 0 && minHeight < 44) {
                            allPass = false;
                            details += `${width}px: button min-height ${minHeight}px < 44px; `;
                        }
                    }
                    
                    document.body.removeChild(iframe);
                }, 100);
            }
            
            setTimeout(() => {
                logTest('Buttons have touch-friendly sizes on mobile', allPass, details);
                continueTests();
            }, 900);
        }

        // Test 6: Touch-friendly input sizes on mobile
        function testTouchFriendlyInputs() {
            const mobileWidths = [375, 414, 600];
            let allPass = true;
            let details = '';
            
            for (const width of mobileWidths) {
                const iframe = createViewportSimulator(width);
                
                setTimeout(() => {
                    const doc = iframe.contentDocument;
                    const input = doc.querySelector('.form-input');
                    
                    if (input) {
                        const styles = iframe.contentWindow.getComputedStyle(input);
                        const minHeight = parseFloat(styles.minHeight);
                        
                        // Touch-friendly minimum is 44px
                        if (minHeight > 0 && minHeight < 44) {
                            allPass = false;
                            details += `${width}px: input min-height ${minHeight}px < 44px; `;
                        }
                    }
                    
                    document.body.removeChild(iframe);
                }, 100);
            }
            
            setTimeout(() => {
                logTest('Form inputs have touch-friendly sizes on mobile', allPass, details);
                continueTests();
            }, 1000);
        }

        // Test 7: Property-based test - random viewport widths
        function testRandomViewports() {
            const iterations = 100;
            let failures = [];
            
            for (let i = 0; i < iterations; i++) {
                // Generate random viewport width
                const width = Math.floor(Math.random() * (1920 - 320 + 1)) + 320;
                const deviceType = getDeviceType(width);
                
                const iframe = createViewportSimulator(width);
                
                setTimeout(() => {
                    const doc = iframe.contentDocument;
                    const toggle = doc.querySelector('.mobile-menu-toggle');
                    
                    if (toggle) {
                        const styles = iframe.contentWindow.getComputedStyle(toggle);
                        const display = styles.display;
                        
                        if (deviceType === 'mobile' && display === 'none') {
                            failures.push(`${width}px (mobile): toggle hidden`);
                        } else if (deviceType !== 'mobile' && display !== 'none') {
                            failures.push(`${width}px (${deviceType}): toggle visible`);
                        }
                    }
                    
                    document.body.removeChild(iframe);
                }, 100);
            }
            
            setTimeout(() => {
                const passed = failures.length === 0;
                logTest(`Property test: ${iterations} random viewport checks`, passed,
                    failures.length > 0 ? failures.slice(0, 5).join('; ') : '');
                displayResults();
            }, 1200);
        }

        // Test sequencer
        let testIndex = 0;
        const tests = [
            testMobileMenuToggle,
            testNavigationLayout,
            testContainerPadding,
            testTypographyScaling,
            testTouchFriendlyButtons,
            testTouchFriendlyInputs,
            testRandomViewports
        ];

        function continueTests() {
            testIndex++;
            if (testIndex < tests.length) {
                tests[testIndex]();
            }
        }

        // Display results
        function displayResults() {
            const output = document.getElementById('test-output');
            testResults.forEach(result => {
                const div = document.createElement('div');
                div.className = `test-item ${result.passed ? 'pass' : 'fail'}`;
                div.innerHTML = `
                    <span class="${result.passed ? 'test-pass' : 'test-fail'}">
                        ${result.passed ? 'âœ“ PASS' : 'âœ— FAIL'}
                    </span>
                    <strong>${result.name}</strong>
                    ${result.details ? `<br><small>${result.details}</small>` : ''}
                `;
                output.appendChild(div);
            });
            
            // Display summary
            const summary = document.getElementById('summary');
            const totalTests = passCount + failCount;
            const passRate = totalTests > 0 ? ((passCount / totalTests) * 100).toFixed(1) : 0;
            
            summary.innerHTML = `
                <h3>Test Summary</h3>
                <p><strong>Total Tests:</strong> ${totalTests}</p>
                <p><strong>Passed:</strong> <span class="test-pass">${passCount}</span></p>
                <p><strong>Failed:</strong> <span class="test-fail">${failCount}</span></p>
                <p><strong>Pass Rate:</strong> ${passRate}%</p>
                <p><strong>Status:</strong> ${failCount === 0 ? '<span class="test-pass">ALL TESTS PASSED âœ“</span>' : '<span class="test-fail">SOME TESTS FAILED âœ—</span>'}</p>
            `;
        }

        // Run tests when page loads
        window.addEventListener('load', () => {
            setTimeout(() => {
                tests[0](); // Start first test
            }, 100);
        });
    </script>
</body>
</html>
